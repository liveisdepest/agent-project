## 1.3 研究内容与研究方法

本研究旨在构建一个基于 **Model Context Protocol (MCP)** 的智能农业决策系统。该系统采用模块化的 Client-Server 架构，通过标准化协议将智能决策逻辑与底层功能服务解耦，实现灵活、可扩展的精准农业管理。

### 1.3.1 研究内容

系统的核心架构包含一个作为中央控制器的 **MCP 客户端** 以及四个专注于不同功能领域的 **MCP 服务端**。

#### 1. 智能 MCP 客户端 (MCP Client)
客户端是整个系统的“大脑”，基于 Python 开发，通过 OpenAI 兼容接口连接本地部署的 **Ollama** 服务，利用 **qwen2.5** 等开源大语言模型 (LLM) 的推理能力。其内部实现了**三阶段决策工作流**：
*   **感知层 (Perception Phase)**：主动调用底层服务工具，聚合土壤湿度、天气预报等多维环境数据。
*   **决策层 (Reasoning Phase)**：结合感知数据，并利用浏览器服务检索互联网上的实时农业知识（如作物种植指南、突发气象预警），进行综合研判，生成具备可解释性的决策报告。
*   **执行层 (Action Phase)**：根据决策结果调用硬件控制接口，并内置“人机回环” (Human-in-the-loop) 机制，在执行水泵开启等关键操作前强制要求用户确认，保障系统安全。

#### 2. 气象数据 MCP 服务 (Weather MCP)
该服务专注于气象环境数据的供给。它封装了气象数据接口，能够向客户端提供实时天气状况及未来一周的天气预报（`get_forecast_week`）。这些数据是智能灌溉决策的重要依据，帮助系统实现“雨前不灌、雨后少灌”的节水策略。

#### 3. 灌溉控制 MCP 服务 (Irrigation MCP)
该服务是数字系统与物理农田交互的桥梁，主要包含两类功能：
*   **环境感知**：模拟或读取真实的土壤湿度传感器数据（`get_sensor_data`），为系统提供精准的农田墒情。
*   **设备控制**：封装水泵等灌溉设备的控制逻辑（`control_pump`），支持根据客户端指令执行远程开启或关闭操作。

#### 4. 浏览器自动化 MCP 服务 (Browser Use MCP)
该服务集成了无头浏览器技术，赋予了系统“联网检索”的能力。在面对复杂或未知的农业问题时，系统可调用该服务（`browser_use`）自动访问互联网，获取最新的专家建议或市场动态，从而实现检索增强生成 (RAG) 式的智能决策。

#### 5. 文件系统 MCP 服务 (Filesystem MCP)
该服务提供标准化的文件操作能力，支持系统对本地文件进行读写管理。主要用于系统日志记录、配置文件读取以及决策历史的持久化存储，确保系统运行数据的可追溯性。

### 1.3.2 研究方法

#### 1. 基于 MCP 协议的微服务集成方法
本研究摒弃了传统的单体应用架构，采用 Model Context Protocol (MCP) 标准构建微服务生态。通过定义统一的工具调用接口 (Tools) 和资源访问协议，实现了客户端与各异构服务端（如气象 API、硬件驱动、浏览器引擎）的无缝对接。这种方法极大地降低了系统耦合度，使得各个 MCP 服务可以独立开发、测试和部署。

#### 2. LLM 驱动的 ReAct 决策范式
在控制逻辑上，研究采用了 **ReAct (Reasoning + Acting)** 范式。系统不仅仅是根据阈值进行简单的逻辑判断，而是利用大语言模型对环境数据进行语义理解和逻辑推理。通过“观察-思考-行动”的循环，系统能够处理复杂的非结构化信息（如天气描述、网页文本），并生成符合人类逻辑的决策依据。

#### 3. 分层式智能代理 (Hierarchical Agent) 设计
为了提高系统的鲁棒性和可维护性，研究将复杂的决策任务拆解为感知、决策、执行三个独立的阶段。每个阶段配备专门的提示词 (Prompt) 和工具集 (Tool Set)，确保 LLM 在特定阶段专注于特定任务，避免了单一长上下文带来的注意力分散和逻辑幻觉问题。

#### 4. 虚实结合的仿真验证
在研究过程中，采用了软件仿真与硬件在环相结合的方法。对于难以实时获取的气象突变或硬件故障场景，通过在 MCP 服务端构建模拟环境进行测试；待逻辑验证成熟后，再接入真实传感器和控制器，确保系统在实际农业生产环境中的可靠性。
